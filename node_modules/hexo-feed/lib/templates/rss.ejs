<?xml version="1.0"?>
<rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title><%= config.title %><%= tag ? ` • Posts by "${tag}" tag` : '' %><%= category ? ` • Posts by "${category}" category` : '' %></title>
        <link><%- config.url %></link>
        <description><%= config.description %></description>
        <image>
            <url><%= config.url + config.logo %></url>
            <title><%= config.title %></title>
            <link><%- config.url %></link>
        </image>
        <language><%= config.language %></language>
        <pubDate><%= moment(lastBuildDate).locale('en').format('ddd, DD MMM YYYY HH:mm:ss ZZ') %></pubDate>
        <lastBuildDate><%= moment(lastBuildDate).locale('en').format('ddd, DD MMM YYYY HH:mm:ss ZZ') %></lastBuildDate>
        <%_ for (const { name } of (tags || [])) { _%>
        <category><%= name %></category>
        <%_ } _%>
        <%_ for (const post of posts) { _%>
        <item>
            <guid isPermaLink="true"><%= post.permalink %></guid>
            <title><%= post.title %></title>
            <description><%= post.description %></description>
            <creator><%= post.author %></creator>
            <link><%= post.permalink %></link>
            <%_ for (const tag of (post.tags ? post.tags.toArray() : [])) { _%>
            <category><%= tag.name %></category>
            <%_ } _%>
            <pubDate><%= moment(post.date).locale('en').format('ddd, DD MMM YYYY HH:mm:ss ZZ') %></pubDate>
            <% if (post.enclosure) { %><enclosure url="<%= post.enclosure.url %>" length="0" type="<%= post.enclosure.type %>" /><% } %>
            <content:encoded><![CDATA[ <%- post.content %> ]]></content:encoded>
        </item>
        <%_ } _%>
    </channel>
</rss>